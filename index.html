<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>POP the corn!</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Press Start 2P', cursive;
      text-align: center;
      margin: 0;
      padding-top: 100px;
      background-color: #fffbe6;
      overflow: hidden;
      height: 100vh;
      position: relative;
      border: 40px solid rgba(255, 204, 0, 0.2); /* frame m·ªù */
      box-sizing: border-box;
    }

    h1 {
      margin-bottom: 40px;
      font-size: 18px;
      color: #ff6666;
      text-shadow: 2px 2px #333;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }

    #emojiBox {
      font-size: 100px;
      transition: all 0.5s ease;
      display: inline-block;
      position: relative;
      z-index: 1;
    }

    #emojiBox.active {
      transform: scale(1.3) rotate(10deg);
    }

    .pixel-button {
      margin-top: 30px;
      padding: 16px 30px;
      font-size: 14px;
      background-color: #ffcc00;
      border: 4px solid #333;
      border-radius: 4px;
      cursor: pointer;
      font-family: 'Press Start 2P', cursive;
      transition: background-color 0.3s ease;
    }

    .pixel-button:hover {
      background-color: #ffaa00;
    }

    #countdown {
      font-size: 16px;
      margin-top: 20px;
      color: #444;
    }

    .popcorn-gif {
      position: absolute;
      width: 200px;
      height: 200px;
      animation: pop 2s ease-out forwards;
      pointer-events: none;
      z-index: 0;
      will-change: transform, opacity;
    }

    @keyframes pop {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(1) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translate(var(--x), var(--y)) scale(0.7) rotate(var(--r));
      }
    }
  </style>
</head>
<body>

  <h1>POP the corn!</h1>

  <div id="emojiBox">üåΩ</div>

  <br>
  <button id="cookBtn" class="pixel-button" onclick="startCooking()">COOK</button>
  <div id="countdown"></div>
  <br>
  <button id="againBtn" class="pixel-button" style="display:none;" onclick="reset()">AGAIN</button>

  <script>
    let transformed = false;
    let countdownInterval;

    function startCooking() {
      const btn = document.getElementById("cookBtn");
      const countdown = document.getElementById("countdown");
      let count = 3;
      countdown.textContent = `Cooking in ${count}...`;
      btn.disabled = true;

      countdownInterval = setInterval(() => {
        count--;
        if (count > 0) {
          countdown.textContent = `Cooking in ${count}...`;
        } else {
          clearInterval(countdownInterval);
          countdown.textContent = "";
          transform();
        }
      }, 1000);
    }

    function transform() {
      const emojiBox = document.getElementById("emojiBox");
      const btn = document.getElementById("cookBtn");
      transformed = true;

      emojiBox.textContent = "üçø";
      emojiBox.classList.add("active");

      for (let i = 0; i < 40; i++) {
        createPopcornGIF(emojiBox);
      }

      btn.textContent = "COOKED!";
      document.getElementById("againBtn").style.display = "inline-block";
    }

    function reset() {
      transformed = false;
      document.getElementById("emojiBox").textContent = "üåΩ";
      document.getElementById("emojiBox").classList.remove("active");
      const btn = document.getElementById("cookBtn");
      btn.textContent = "COOK";
      btn.disabled = false;
      document.getElementById("againBtn").style.display = "none";
      document.getElementById("countdown").textContent = "";
    }

    function createPopcornGIF(origin) {
      const gif = document.createElement("img");
      gif.className = "popcorn-gif";
      gif.src = "https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExNmlqc2VpOWh4eXhleW55ZGpudnhhcTRsdHBzMjQwMDkybGRoNW1kMSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/daG6C0PH6vEU8/giphy.gif";

      const rect = origin.getBoundingClientRect();
      gif.style.left = `${rect.left + rect.width / 2}px`;
      gif.style.top = `${rect.top + rect.height / 2}px`;

      const angle = Math.random() * 2 * Math.PI;
      const distance = Math.random() * 800 + 100;
      const x = Math.cos(angle) * distance;
      const y = Math.sin(angle) * distance;
      const rotate = Math.floor(Math.random() * 360) + "deg";

      gif.style.setProperty('--x', `${x}px`);
      gif.style.setProperty('--y', `${y}px`);
      gif.style.setProperty('--r', rotate);

      document.body.appendChild(gif);
      setTimeout(() => gif.remove(), 2000);
    }
  </script>

</body>
</html>
